<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Class: BigRecord::ArAssociations::AssociationCollection</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo; 
    <span class='title'><a href="../../BigRecord.html" title="BigRecord (module)">BigRecord</a></span> &raquo; <span class='title'><a href="../ArAssociations.html" title="BigRecord::ArAssociations (module)">ArAssociations</a></span>
     &raquo; 
    <span class="title">AssociationCollection</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: BigRecord::ArAssociations::AssociationCollection 
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><a href="AssociationProxy.html" title="BigRecord::ArAssociations::AssociationProxy (class)">AssociationProxy</a></span>
      
        <ul class="fullTree">
          <li><a href="../../Object.html" title="Object (class)">Object</a></li>
          
            <li class="next"><a href="AssociationProxy.html" title="BigRecord::ArAssociations::AssociationProxy (class)">AssociationProxy</a></li>
          
            <li class="next">BigRecord::ArAssociations::AssociationCollection</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/big_record/ar_associations/association_collection.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
:nodoc:
</p>


  </div>
</div>
<div class="tags">
  
</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><a href="HasAndBelongsToManyAssociation.html" title="BigRecord::ArAssociations::HasAndBelongsToManyAssociation (class)">HasAndBelongsToManyAssociation</a>, <a href="HasManyAssociation.html" title="BigRecord::ArAssociations::HasManyAssociation (class)">HasManyAssociation</a></p>
</div>


  
  
  
  

  
    <h2>Instance Method Summary</h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%3C%3C-instance_method" title="#&lt;&lt; (instance method)">- (Object) <strong>&lt;&lt;</strong>(*records) </a>
    

    
      (also: #push)
    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Add <tt>records</tt> to this association.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear-instance_method" title="#clear (instance method)">- (Object) <strong>clear</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Removes all records from this association.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-instance_method" title="#create (instance method)">- (Object) <strong>create</strong>(attributes = {}) </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete-instance_method" title="#delete (instance method)">- (Object) <strong>delete</strong>(*records) </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Remove <tt>records</tt> from this association.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#destroy_all-instance_method" title="#destroy_all (instance method)">- (Object) <strong>destroy_all</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#empty%3F-instance_method" title="#empty? (instance method)">- (Boolean) <strong>empty?</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#length-instance_method" title="#length (instance method)">- (Object) <strong>length</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the size of the collection by loading it and calling size on the
array.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#replace-instance_method" title="#replace (instance method)">- (Object) <strong>replace</strong>(other_array) </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Replace this collection with <tt>other_array</tt> This will perform a diff
and delete/add only records that have changed.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset-instance_method" title="#reset (instance method)">- (Object) <strong>reset</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#size-instance_method" title="#size (instance method)">- (Object) <strong>size</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the size of the collection by executing a SELECT COUNT(*) query if
the collection hasn&#8217;t been loaded and calling collection.size if it
has.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sum-instance_method" title="#sum (instance method)">- (Object) <strong>sum</strong>(*args, &amp;block) </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Calculate sum using SQL, not Enumerable.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_ary-instance_method" title="#to_ary (instance method)">- (Object) <strong>to_ary</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#uniq-instance_method" title="#uniq (instance method)">- (Object) <strong>uniq</strong>(collection = self) </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <a href="AssociationProxy.html" title="BigRecord::ArAssociations::AssociationProxy (class)">AssociationProxy</a></h3>
  <p class="inherited"><a href="AssociationProxy.html#%3D%3D%3D-instance_method" title="BigRecord::ArAssociations::AssociationProxy#=== (method)">#===</a>, <a href="AssociationProxy.html#aliased_table_name-instance_method" title="BigRecord::ArAssociations::AssociationProxy#aliased_table_name (method)">#aliased_table_name</a>, <a href="AssociationProxy.html#conditions-instance_method" title="BigRecord::ArAssociations::AssociationProxy#conditions (method)">#conditions</a>, <a href="AssociationProxy.html#initialize-instance_method" title="BigRecord::ArAssociations::AssociationProxy#initialize (method)">#initialize</a>, <a href="AssociationProxy.html#loaded-instance_method" title="BigRecord::ArAssociations::AssociationProxy#loaded (method)">#loaded</a>, <a href="AssociationProxy.html#loaded%3F-instance_method" title="BigRecord::ArAssociations::AssociationProxy#loaded? (method)">#loaded?</a>, <a href="AssociationProxy.html#proxy_owner-instance_method" title="BigRecord::ArAssociations::AssociationProxy#proxy_owner (method)">#proxy_owner</a>, <a href="AssociationProxy.html#proxy_reflection-instance_method" title="BigRecord::ArAssociations::AssociationProxy#proxy_reflection (method)">#proxy_reflection</a>, <a href="AssociationProxy.html#proxy_target-instance_method" title="BigRecord::ArAssociations::AssociationProxy#proxy_target (method)">#proxy_target</a>, <a href="AssociationProxy.html#reload-instance_method" title="BigRecord::ArAssociations::AssociationProxy#reload (method)">#reload</a>, <a href="AssociationProxy.html#respond_to%3F-instance_method" title="BigRecord::ArAssociations::AssociationProxy#respond_to? (method)">#respond_to?</a>, <a href="AssociationProxy.html#target-instance_method" title="BigRecord::ArAssociations::AssociationProxy#target (method)">#target</a>, <a href="AssociationProxy.html#target%3D-instance_method" title="BigRecord::ArAssociations::AssociationProxy#target= (method)">#target=</a></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <p class="notice">This class inherits a constructor from <a href="AssociationProxy.html#initialize-instance_method" title="BigRecord::ArAssociations::AssociationProxy#initialize (method)">BigRecord::ArAssociations::AssociationProxy</a></p>
  
</div>
<div id="method_missing_details" class="method_details_list">
  <h2>Dynamic Method Handling</h2>
  <p class="notice super">
    This class handles dynamic methods through the <tt>method_missing</tt> method
    
      in the class <a href="AssociationProxy.html#method_missing-instance_method" title="BigRecord::ArAssociations::AssociationProxy#method_missing (method)">BigRecord::ArAssociations::AssociationProxy</a>
    
  </p>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="<<-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>&lt;&lt;</strong>(*records) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='push-instance_method'>push</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    <p>
Add <tt>records</tt> to this association. Returns <tt>self</tt> so method
calls may be chained. Since &lt;&lt; flattens its argument list and inserts
each record, <tt>push</tt> and <tt>concat</tt> behave identically.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 18</span>

<span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='records identifier id'>records</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='load_target identifier id'>load_target</span>

  <span class='comment val'># HbaseAdapter doesn't support transactions</span>
<span class='comment val'>#        @owner.transaction do</span>
    <span class='flatten_deeper identifier id'>flatten_deeper</span><span class='lparen token'>(</span><span class='records identifier id'>records</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='record identifier id'>record</span><span class='bitor op'>|</span>
      <span class='raise_on_type_mismatch identifier id'>raise_on_type_mismatch</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='rparen token'>)</span>
      <span class='callback identifier id'>callback</span><span class='lparen token'>(</span><span class='symbol val'>:before_add</span><span class='comma token'>,</span> <span class='record identifier id'>record</span><span class='rparen token'>)</span>
      <span class='result identifier id'>result</span> <span class='opasgn op'>&amp;&amp;=</span> <span class='insert_record identifier id'>insert_record</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='@owner ivar id'>@owner</span><span class='dot token'>.</span><span class='new_record? fid id'>new_record?</span>
      <span class='@target ivar id'>@target</span> <span class='lshft op'>&lt;&lt;</span> <span class='record identifier id'>record</span>
      <span class='callback identifier id'>callback</span><span class='lparen token'>(</span><span class='symbol val'>:after_add</span><span class='comma token'>,</span> <span class='record identifier id'>record</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
<span class='comment val'>#        end</span>

  <span class='result identifier id'>result</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="clear-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>clear</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Removes all records from this association. Returns <tt>self</tt> so method
calls may be chained.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72
73
74
75
76
77
78
79
80</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 70</span>

<span class='def def kw'>def</span> <span class='clear identifier id'>clear</span>
  <span class='return return kw'>return</span> <span class='self self kw'>self</span> <span class='if if_mod kw'>if</span> <span class='length identifier id'>length</span><span class='dot token'>.</span><span class='zero? fid id'>zero?</span> <span class='comment val'># forces load_target if hasn't happened already</span>

  <span class='if if kw'>if</span> <span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:dependent</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:dependent</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='symbol val'>:delete_all</span>
    <span class='destroy_all identifier id'>destroy_all</span>
  <span class='else else kw'>else</span>
    <span class='delete_all identifier id'>delete_all</span>
  <span class='end end kw'>end</span>

  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="create-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>create</strong>(attributes = {}) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


91
92
93
94
95
96
97
98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 91</span>

<span class='def def kw'>def</span> <span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='comment val'># Can't use Base.create since the foreign key may be a protected attribute.</span>
  <span class='if if kw'>if</span> <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
    <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='attr identifier id'>attr</span><span class='bitor op'>|</span> <span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='attr identifier id'>attr</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='else else kw'>else</span>
    <span class='record identifier id'>record</span> <span class='assign token'>=</span> <span class='build identifier id'>build</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span>
    <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='save identifier id'>save</span> <span class='unless unless_mod kw'>unless</span> <span class='@owner ivar id'>@owner</span><span class='dot token'>.</span><span class='new_record? fid id'>new_record?</span>
    <span class='record identifier id'>record</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="delete-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>delete</strong>(*records) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Remove <tt>records</tt> from this association. Does not destroy
<tt>records</tt>.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 52</span>

<span class='def def kw'>def</span> <span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='records identifier id'>records</span><span class='rparen token'>)</span>
  <span class='records identifier id'>records</span> <span class='assign token'>=</span> <span class='flatten_deeper identifier id'>flatten_deeper</span><span class='lparen token'>(</span><span class='records identifier id'>records</span><span class='rparen token'>)</span>
  <span class='records identifier id'>records</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='record identifier id'>record</span><span class='bitor op'>|</span> <span class='raise_on_type_mismatch identifier id'>raise_on_type_mismatch</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='records identifier id'>records</span><span class='dot token'>.</span><span class='reject! fid id'>reject!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='record identifier id'>record</span><span class='bitor op'>|</span> <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='new_record? fid id'>new_record?</span> <span class='rbrace token'>}</span>
  <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='records identifier id'>records</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>

  <span class='comment val'># HbaseAdapter doesn't support transactions</span>
<span class='comment val'>#        @owner.transaction do</span>
    <span class='records identifier id'>records</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='record identifier id'>record</span><span class='bitor op'>|</span> <span class='callback identifier id'>callback</span><span class='lparen token'>(</span><span class='symbol val'>:before_remove</span><span class='comma token'>,</span> <span class='record identifier id'>record</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
    <span class='delete_records identifier id'>delete_records</span><span class='lparen token'>(</span><span class='records identifier id'>records</span><span class='rparen token'>)</span>
    <span class='records identifier id'>records</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='record identifier id'>record</span><span class='bitor op'>|</span>
      <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='rparen token'>)</span>
      <span class='callback identifier id'>callback</span><span class='lparen token'>(</span><span class='symbol val'>:after_remove</span><span class='comma token'>,</span> <span class='record identifier id'>record</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
<span class='comment val'>#        end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="destroy_all-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>destroy_all</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


82
83
84
85
86
87
88
89</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 82</span>

<span class='def def kw'>def</span> <span class='destroy_all identifier id'>destroy_all</span>
  <span class='comment val'># HbaseAdapter doesn't support transactions</span>
<span class='comment val'>#        @owner.transaction do</span>
    <span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='record identifier id'>record</span><span class='bitor op'>|</span> <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='destroy identifier id'>destroy</span> <span class='rbrace token'>}</span>
<span class='comment val'>#        end</span>

  <span class='reset_target! fid id'>reset_target!</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="empty?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>empty?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 122</span>

<span class='def def kw'>def</span> <span class='empty? fid id'>empty?</span>
  <span class='size identifier id'>size</span><span class='dot token'>.</span><span class='zero? fid id'>zero?</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="length-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>length</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the size of the collection by loading it and calling size on the
array. If you want to use this method to check whether the collection is
empty, use collection.length.zero? instead of collection.empty?
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


118
119
120</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 118</span>

<span class='def def kw'>def</span> <span class='length identifier id'>length</span>
  <span class='load_target identifier id'>load_target</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="replace-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>replace</strong>(other_array) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Replace this collection with <tt>other_array</tt> This will perform a diff
and delete/add only records that have changed.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 139</span>

<span class='def def kw'>def</span> <span class='replace identifier id'>replace</span><span class='lparen token'>(</span><span class='other_array identifier id'>other_array</span><span class='rparen token'>)</span>
  <span class='other_array identifier id'>other_array</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='val identifier id'>val</span><span class='bitor op'>|</span> <span class='raise_on_type_mismatch identifier id'>raise_on_type_mismatch</span><span class='lparen token'>(</span><span class='val identifier id'>val</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>

  <span class='load_target identifier id'>load_target</span>
  <span class='other identifier id'>other</span>   <span class='assign token'>=</span> <span class='other_array identifier id'>other_array</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='lt op'>&lt;</span> <span class='integer val'>100</span> <span class='question op'>?</span> <span class='other_array identifier id'>other_array</span> <span class='colon op'>:</span> <span class='other_array identifier id'>other_array</span><span class='dot token'>.</span><span class='to_set identifier id'>to_set</span>
  <span class='current identifier id'>current</span> <span class='assign token'>=</span> <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='lt op'>&lt;</span> <span class='integer val'>100</span> <span class='question op'>?</span> <span class='@target ivar id'>@target</span> <span class='colon op'>:</span> <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='to_set identifier id'>to_set</span>

  <span class='comment val'># HbaseAdapter doesn't support transactions</span>
<span class='comment val'>#        @owner.transaction do</span>
    <span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='other identifier id'>other</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='v identifier id'>v</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='concat identifier id'>concat</span><span class='lparen token'>(</span><span class='other_array identifier id'>other_array</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='current identifier id'>current</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='v identifier id'>v</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
<span class='comment val'>#        end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="reset-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>reset</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13
14</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 11</span>

<span class='def def kw'>def</span> <span class='reset identifier id'>reset</span>
  <span class='@loaded ivar id'>@loaded</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='reset_target! fid id'>reset_target!</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="size-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>size</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the size of the collection by executing a SELECT COUNT(*) query if
the collection hasn&#8217;t been loaded and calling collection.size if it
has. If it&#8217;s more likely than not that the collection does have a
size larger than zero and you need to fetch that collection afterwards,
it&#8217;ll take one less SELECT query if you use length.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


105
106
107
108
109
110
111
112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 105</span>

<span class='def def kw'>def</span> <span class='size identifier id'>size</span>
  <span class='if if kw'>if</span> <span class='loaded? fid id'>loaded?</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:uniq</span><span class='rbrack token'>]</span>
    <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
  <span class='elsif elsif kw'>elsif</span> <span class='notop op'>!</span><span class='loaded? fid id'>loaded?</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:uniq</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
    <span class='unsaved_records identifier id'>unsaved_records</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='lparen token'>(</span><span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='detect identifier id'>detect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='r identifier id'>r</span><span class='bitor op'>|</span> <span class='r identifier id'>r</span><span class='dot token'>.</span><span class='new_record? fid id'>new_record?</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='unsaved_records identifier id'>unsaved_records</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='plus op'>+</span> <span class='count_records identifier id'>count_records</span>
  <span class='else else kw'>else</span>
    <span class='count_records identifier id'>count_records</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="sum-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>sum</strong>(*args, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Calculate sum using SQL, not Enumerable
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


47
48
49</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 47</span>

<span class='def def kw'>def</span> <span class='sum identifier id'>sum</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='calculate identifier id'>calculate</span><span class='lparen token'>(</span><span class='symbol val'>:sum</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='args identifier id'>args</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_ary-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>to_ary</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


6
7
8
9</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 6</span>

<span class='def def kw'>def</span> <span class='to_ary identifier id'>to_ary</span>
  <span class='load_target identifier id'>load_target</span>
  <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='to_ary identifier id'>to_ary</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="uniq-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>uniq</strong>(collection = self) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128
129
130
131
132
133
134
135</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/ar_associations/association_collection.rb', line 126</span>

<span class='def def kw'>def</span> <span class='uniq identifier id'>uniq</span><span class='lparen token'>(</span><span class='collection identifier id'>collection</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='rparen token'>)</span>
  <span class='seen identifier id'>seen</span> <span class='assign token'>=</span> <span class='Set constant id'>Set</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='collection identifier id'>collection</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='kept identifier id'>kept</span><span class='comma token'>,</span> <span class='record identifier id'>record</span><span class='bitor op'>|</span>
    <span class='unless unless kw'>unless</span> <span class='seen identifier id'>seen</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='dot token'>.</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
      <span class='kept identifier id'>kept</span> <span class='lshft op'>&lt;&lt;</span> <span class='record identifier id'>record</span>
      <span class='seen identifier id'>seen</span> <span class='lshft op'>&lt;&lt;</span> <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='id identifier id'>id</span>
    <span class='end end kw'>end</span>
    <span class='kept identifier id'>kept</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Fri Apr 30 12:48:51 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool">yard</a>
  0.5.4 (ruby-1.8.7).
</div>

  </body>
</html>