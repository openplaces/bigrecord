<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf8" />
<title>Class: BigRecord::BrAssociations::BelongsToManyAssociation</title>
<link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (B)</a> &raquo; 
    <span class='title'><a href="../../BigRecord.html" title="BigRecord (module)">BigRecord</a></span> &raquo; <span class='title'><a href="../BrAssociations.html" title="BigRecord::BrAssociations (module)">BrAssociations</a></span>
     &raquo; 
    <span class="title">BelongsToManyAssociation</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: BigRecord::BrAssociations::BelongsToManyAssociation 
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><a href="AssociationProxy.html" title="BigRecord::BrAssociations::AssociationProxy (class)">AssociationProxy</a></span>
      
        <ul class="fullTree">
          <li><a href="../../Object.html" title="Object (class)">Object</a></li>
          
            <li class="next"><a href="AssociationProxy.html" title="BigRecord::BrAssociations::AssociationProxy (class)">AssociationProxy</a></li>
          
            <li class="next">BigRecord::BrAssociations::BelongsToManyAssociation</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/big_record/br_associations/belongs_to_many_association.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
:nodoc:
</p>


  </div>
</div>
<div class="tags">
  
</div>

  
  
  
  

  
    <h2>Instance Method Summary</h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%3C%3C-instance_method" title="#&lt;&lt; (instance method)">- (Object) <strong>&lt;&lt;</strong>(*records) </a>
    

    
      (also: #push)
    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Add <tt>records</tt> to this association.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build-instance_method" title="#build (instance method)">- (Object) <strong>build</strong>(attributes = {}) </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear-instance_method" title="#clear (instance method)">- (Object) <strong>clear</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Removes all records from this association.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#count-instance_method" title="#count (instance method)">- (Object) <strong>count</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Count the number of associated records.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-instance_method" title="#create (instance method)">- (Object) <strong>create</strong>(attributes = {}) </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete-instance_method" title="#delete (instance method)">- (Object) <strong>delete</strong>(*records) </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Remove <tt>records</tt> from this association.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#destroy_all-instance_method" title="#destroy_all (instance method)">- (Object) <strong>destroy_all</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#empty%3F-instance_method" title="#empty? (instance method)">- (Boolean) <strong>empty?</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find-instance_method" title="#find (instance method)">- (Object) <strong>find</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#length-instance_method" title="#length (instance method)">- (Object) <strong>length</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the size of the collection by loading it and calling size on the
array.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#replace-instance_method" title="#replace (instance method)">- (Object) <strong>replace</strong>(other_array) </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Replace this collection with <tt>other_array</tt> This will perform a diff
and delete/add only records that have changed.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset-instance_method" title="#reset (instance method)">- (Object) <strong>reset</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#size-instance_method" title="#size (instance method)">- (Object) <strong>size</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the size of the collection by executing a SELECT COUNT(*) query if
the collection hasn&#8217;t been loaded and calling collection.size if it
has.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_ary-instance_method" title="#to_ary (instance method)">- (Object) <strong>to_ary</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#uniq-instance_method" title="#uniq (instance method)">- (Object) <strong>uniq</strong>(collection = self) </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#updated%3F-instance_method" title="#updated? (instance method)">- (Boolean) <strong>updated?</strong> </a>
    

    
  </span>
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <a href="AssociationProxy.html" title="BigRecord::BrAssociations::AssociationProxy (class)">AssociationProxy</a></h3>
  <p class="inherited"><a href="AssociationProxy.html#%3D%3D%3D-instance_method" title="BigRecord::BrAssociations::AssociationProxy#=== (method)">#===</a>, <a href="AssociationProxy.html#aliased_table_name-instance_method" title="BigRecord::BrAssociations::AssociationProxy#aliased_table_name (method)">#aliased_table_name</a>, <a href="AssociationProxy.html#initialize-instance_method" title="BigRecord::BrAssociations::AssociationProxy#initialize (method)">#initialize</a>, <a href="AssociationProxy.html#loaded-instance_method" title="BigRecord::BrAssociations::AssociationProxy#loaded (method)">#loaded</a>, <a href="AssociationProxy.html#loaded%3F-instance_method" title="BigRecord::BrAssociations::AssociationProxy#loaded? (method)">#loaded?</a>, <a href="AssociationProxy.html#proxy_owner-instance_method" title="BigRecord::BrAssociations::AssociationProxy#proxy_owner (method)">#proxy_owner</a>, <a href="AssociationProxy.html#proxy_reflection-instance_method" title="BigRecord::BrAssociations::AssociationProxy#proxy_reflection (method)">#proxy_reflection</a>, <a href="AssociationProxy.html#proxy_target-instance_method" title="BigRecord::BrAssociations::AssociationProxy#proxy_target (method)">#proxy_target</a>, <a href="AssociationProxy.html#reload-instance_method" title="BigRecord::BrAssociations::AssociationProxy#reload (method)">#reload</a>, <a href="AssociationProxy.html#respond_to%3F-instance_method" title="BigRecord::BrAssociations::AssociationProxy#respond_to? (method)">#respond_to?</a>, <a href="AssociationProxy.html#target-instance_method" title="BigRecord::BrAssociations::AssociationProxy#target (method)">#target</a>, <a href="AssociationProxy.html#target%3D-instance_method" title="BigRecord::BrAssociations::AssociationProxy#target= (method)">#target=</a></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <p class="notice">This class inherits a constructor from <a href="AssociationProxy.html#initialize-instance_method" title="BigRecord::BrAssociations::AssociationProxy#initialize (method)">BigRecord::BrAssociations::AssociationProxy</a></p>
  
</div>
<div id="method_missing_details" class="method_details_list">
  <h2>Dynamic Method Handling</h2>
  <p class="notice super">
    This class handles dynamic methods through the <tt>method_missing</tt> method
    
      in the class <a href="AssociationProxy.html#method_missing-instance_method" title="BigRecord::BrAssociations::AssociationProxy#method_missing (method)">BigRecord::BrAssociations::AssociationProxy</a>
    
  </p>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="<<-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>&lt;&lt;</strong>(*records) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='push-instance_method'>push</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    <p>
Add <tt>records</tt> to this association. Returns <tt>self</tt> so method
calls may be chained. Since &lt;&lt; flattens its argument list and inserts
each record, <tt>push</tt> and <tt>concat</tt> behave identically.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 16</span>

<span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='records identifier id'>records</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='load_target identifier id'>load_target</span>

  <span class='flatten_deeper identifier id'>flatten_deeper</span><span class='lparen token'>(</span><span class='records identifier id'>records</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='record identifier id'>record</span><span class='bitor op'>|</span>
    <span class='raise_on_type_mismatch identifier id'>raise_on_type_mismatch</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='rparen token'>)</span>
    <span class='callback identifier id'>callback</span><span class='lparen token'>(</span><span class='symbol val'>:before_add</span><span class='comma token'>,</span> <span class='record identifier id'>record</span><span class='rparen token'>)</span>
    <span class='result identifier id'>result</span> <span class='opasgn op'>&amp;&amp;=</span> <span class='insert_record identifier id'>insert_record</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='rparen token'>)</span>
    <span class='@target ivar id'>@target</span> <span class='lshft op'>&lt;&lt;</span> <span class='record identifier id'>record</span>
    <span class='callback identifier id'>callback</span><span class='lparen token'>(</span><span class='symbol val'>:after_add</span><span class='comma token'>,</span> <span class='record identifier id'>record</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='result identifier id'>result</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="build-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>build</strong>(attributes = {}) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


187
188
189
190
191
192
193
194
195
196
197
198
199</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 187</span>

<span class='def def kw'>def</span> <span class='build identifier id'>build</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
    <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='attr identifier id'>attr</span><span class='bitor op'>|</span> <span class='build identifier id'>build</span><span class='lparen token'>(</span><span class='attr identifier id'>attr</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='else else kw'>else</span>
    <span class='record identifier id'>record</span> <span class='assign token'>=</span> <span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='klass identifier id'>klass</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span>
    <span class='set_belongs_to_association_for identifier id'>set_belongs_to_association_for</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='rparen token'>)</span>

    <span class='@target ivar id'>@target</span> <span class='opasgn op'>||=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> <span class='unless unless_mod kw'>unless</span> <span class='loaded? fid id'>loaded?</span>
    <span class='@target ivar id'>@target</span> <span class='lshft op'>&lt;&lt;</span> <span class='record identifier id'>record</span>

    <span class='record identifier id'>record</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="clear-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>clear</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Removes all records from this association. Returns <tt>self</tt> so method
calls may be chained.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


62
63
64
65
66
67
68
69
70
71
72</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 62</span>

<span class='def def kw'>def</span> <span class='clear identifier id'>clear</span>
  <span class='return return kw'>return</span> <span class='self self kw'>self</span> <span class='if if_mod kw'>if</span> <span class='length identifier id'>length</span><span class='dot token'>.</span><span class='zero? fid id'>zero?</span> <span class='comment val'># forces load_target if hasn't happened already</span>

  <span class='if if kw'>if</span> <span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:dependent</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:dependent</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='symbol val'>:delete_all</span>
    <span class='destroy_all identifier id'>destroy_all</span>
  <span class='else else kw'>else</span>
    <span class='delete_all identifier id'>delete_all</span>
  <span class='end end kw'>end</span>

  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="count-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>count</strong>(*args) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Count the number of associated records. All arguments are optional.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


202
203
204
205</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 202</span>

<span class='def def kw'>def</span> <span class='count identifier id'>count</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
  <span class='load_target identifier id'>load_target</span>
  <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="create-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>create</strong>(attributes = {}) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85
86
87
88
89
90
91
92</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 83</span>

<span class='def def kw'>def</span> <span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='comment val'># Can't use Base.create since the foreign key may be a protected attribute.</span>
  <span class='if if kw'>if</span> <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
    <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='attr identifier id'>attr</span><span class='bitor op'>|</span> <span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='attr identifier id'>attr</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='else else kw'>else</span>
    <span class='record identifier id'>record</span> <span class='assign token'>=</span> <span class='build identifier id'>build</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span>
    <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='save identifier id'>save</span> <span class='unless unless_mod kw'>unless</span> <span class='@owner ivar id'>@owner</span><span class='dot token'>.</span><span class='new_record? fid id'>new_record?</span>
    <span class='record identifier id'>record</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="delete-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>delete</strong>(*records) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Remove <tt>records</tt> from this association. Does not destroy
<tt>records</tt>.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


47
48
49
50
51
52
53
54
55
56
57
58
59</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 47</span>

<span class='def def kw'>def</span> <span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='records identifier id'>records</span><span class='rparen token'>)</span>
  <span class='records identifier id'>records</span> <span class='assign token'>=</span> <span class='flatten_deeper identifier id'>flatten_deeper</span><span class='lparen token'>(</span><span class='records identifier id'>records</span><span class='rparen token'>)</span>
  <span class='records identifier id'>records</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='record identifier id'>record</span><span class='bitor op'>|</span> <span class='raise_on_type_mismatch identifier id'>raise_on_type_mismatch</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='records identifier id'>records</span><span class='dot token'>.</span><span class='reject! fid id'>reject!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='record identifier id'>record</span><span class='bitor op'>|</span> <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='new_record? fid id'>new_record?</span> <span class='rbrace token'>}</span>
  <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='records identifier id'>records</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>

  <span class='records identifier id'>records</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='record identifier id'>record</span><span class='bitor op'>|</span> <span class='callback identifier id'>callback</span><span class='lparen token'>(</span><span class='symbol val'>:before_remove</span><span class='comma token'>,</span> <span class='record identifier id'>record</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='delete_records identifier id'>delete_records</span><span class='lparen token'>(</span><span class='records identifier id'>records</span><span class='rparen token'>)</span>
  <span class='records identifier id'>records</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='record identifier id'>record</span><span class='bitor op'>|</span>
    <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='rparen token'>)</span>
    <span class='callback identifier id'>callback</span><span class='lparen token'>(</span><span class='symbol val'>:after_remove</span><span class='comma token'>,</span> <span class='record identifier id'>record</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="destroy_all-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>destroy_all</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


74
75
76
77
78
79
80
81</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 74</span>

<span class='def def kw'>def</span> <span class='destroy_all identifier id'>destroy_all</span>
  <span class='comment val'># HbaseAdapter doesn't support transactions</span>
<span class='comment val'>#        @owner.transaction do</span>
    <span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='record identifier id'>record</span><span class='bitor op'>|</span> <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='destroy identifier id'>destroy</span> <span class='rbrace token'>}</span>
<span class='comment val'>#        end</span>

  <span class='reset_target! fid id'>reset_target!</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="empty?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>empty?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 107</span>

<span class='def def kw'>def</span> <span class='empty? fid id'>empty?</span>
  <span class='size identifier id'>size</span><span class='dot token'>.</span><span class='zero? fid id'>zero?</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="find-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>find</strong>(*args) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Raises:</h3>
<ul class="raise">
  
    <li>
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 207</span>

<span class='def def kw'>def</span> <span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>&quot;Only find(:all) is supported&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='args identifier id'>args</span> <span class='eq op'>==</span> <span class='lbrack token'>[</span><span class='symbol val'>:all</span><span class='rbrack token'>]</span>
  <span class='return return kw'>return</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> <span class='if if_mod kw'>if</span> <span class='@owner ivar id'>@owner</span><span class='lbrack token'>[</span><span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='primary_key_name identifier id'>primary_key_name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>

  <span class='if if kw'>if</span> <span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:cache</span><span class='rbrack token'>]</span>
    <span class='comment val'># Create the items proxies using the content that is cached</span>
    <span class='records identifier id'>records</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='@owner ivar id'>@owner</span><span class='lbrack token'>[</span><span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='primary_key_name identifier id'>primary_key_name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='id identifier id'>id</span><span class='bitor op'>|</span>
      <span class='records identifier id'>records</span> <span class='lshft op'>&lt;&lt;</span> <span class='CachedItemProxyFactory constant id'>CachedItemProxyFactory</span><span class='dot token'>.</span><span class='instance identifier id'>instance</span><span class='dot token'>.</span><span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='@owner ivar id'>@owner</span><span class='comma token'>,</span> <span class='@reflection ivar id'>@reflection</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='records identifier id'>records</span>
  <span class='else else kw'>else</span>
    <span class='comment val'># Don't throw an exception when the records are not found</span>
    <span class='records identifier id'>records</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='@owner ivar id'>@owner</span><span class='lbrack token'>[</span><span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='primary_key_name identifier id'>primary_key_name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='id identifier id'>id</span><span class='bitor op'>|</span>
      <span class='begin begin kw'>begin</span>
        <span class='records identifier id'>records</span> <span class='lshft op'>&lt;&lt;</span> <span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='klass identifier id'>klass</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
      <span class='rescue rescue kw'>rescue</span> <span class='BigRecord constant id'>BigRecord</span><span class='colon2 op'>::</span><span class='RecordNotFound constant id'>RecordNotFound</span>
        <span class='comment val'># do nothing</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='records identifier id'>records</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="length-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>length</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the size of the collection by loading it and calling size on the
array. If you want to use this method to check whether the collection is
empty, use collection.length.zero? instead of collection.empty?
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 103</span>

<span class='def def kw'>def</span> <span class='length identifier id'>length</span>
  <span class='load_target identifier id'>load_target</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="replace-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>replace</strong>(other_array) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Replace this collection with <tt>other_array</tt> This will perform a diff
and delete/add only records that have changed.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 124</span>

<span class='def def kw'>def</span> <span class='replace identifier id'>replace</span><span class='lparen token'>(</span><span class='other_array identifier id'>other_array</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='other_array identifier id'>other_array</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='@target ivar id'>@target</span> <span class='assign token'>=</span> <span class='@owner ivar id'>@owner</span><span class='lbrack token'>[</span><span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='primary_key_name identifier id'>primary_key_name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='elsif elsif kw'>elsif</span> <span class='other_array identifier id'>other_array</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='@target ivar id'>@target</span> <span class='assign token'>=</span> <span class='@owner ivar id'>@owner</span><span class='lbrack token'>[</span><span class='@reflection ivar id'>@reflection</span><span class='dot token'>.</span><span class='primary_key_name identifier id'>primary_key_name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='else else kw'>else</span>
    <span class='other_array identifier id'>other_array</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='val identifier id'>val</span><span class='bitor op'>|</span> <span class='raise_on_type_mismatch identifier id'>raise_on_type_mismatch</span><span class='lparen token'>(</span><span class='val identifier id'>val</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>

    <span class='load_target identifier id'>load_target</span>
    <span class='other identifier id'>other</span>   <span class='assign token'>=</span> <span class='other_array identifier id'>other_array</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='lt op'>&lt;</span> <span class='integer val'>100</span> <span class='question op'>?</span> <span class='other_array identifier id'>other_array</span> <span class='colon op'>:</span> <span class='other_array identifier id'>other_array</span><span class='dot token'>.</span><span class='to_set identifier id'>to_set</span>
    <span class='current identifier id'>current</span> <span class='assign token'>=</span> <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='lt op'>&lt;</span> <span class='integer val'>100</span> <span class='question op'>?</span> <span class='@target ivar id'>@target</span> <span class='colon op'>:</span> <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='to_set identifier id'>to_set</span>

    <span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='other identifier id'>other</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='v identifier id'>v</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='concat identifier id'>concat</span><span class='lparen token'>(</span><span class='other_array identifier id'>other_array</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='current identifier id'>current</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='v identifier id'>v</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='@updated ivar id'>@updated</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="reset-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>reset</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11
12</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 9</span>

<span class='def def kw'>def</span> <span class='reset identifier id'>reset</span>
  <span class='@loaded ivar id'>@loaded</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='reset_target! fid id'>reset_target!</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="size-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>size</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the size of the collection by executing a SELECT COUNT(*) query if
the collection hasn&#8217;t been loaded and calling collection.size if it
has. If it&#8217;s more likely than not that the collection does have a
size larger than zero and you need to fetch that collection afterwards,
it&#8217;ll take one less SELECT query if you use length.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 97</span>

<span class='def def kw'>def</span> <span class='size identifier id'>size</span>
  <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_ary-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>to_ary</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6
7</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 4</span>

<span class='def def kw'>def</span> <span class='to_ary identifier id'>to_ary</span>
  <span class='load_target identifier id'>load_target</span>
  <span class='@target ivar id'>@target</span><span class='dot token'>.</span><span class='to_ary identifier id'>to_ary</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="uniq-instance_method">
  
    - (<tt><a href="../../Object.html" title="Object (class)">Object</a></tt>) <strong>uniq</strong>(collection = self) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


111
112
113
114
115
116
117
118
119
120</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 111</span>

<span class='def def kw'>def</span> <span class='uniq identifier id'>uniq</span><span class='lparen token'>(</span><span class='collection identifier id'>collection</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='rparen token'>)</span>
  <span class='seen identifier id'>seen</span> <span class='assign token'>=</span> <span class='Set constant id'>Set</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='collection identifier id'>collection</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='kept identifier id'>kept</span><span class='comma token'>,</span> <span class='record identifier id'>record</span><span class='bitor op'>|</span>
    <span class='unless unless kw'>unless</span> <span class='seen identifier id'>seen</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='record identifier id'>record</span><span class='dot token'>.</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
      <span class='kept identifier id'>kept</span> <span class='lshft op'>&lt;&lt;</span> <span class='record identifier id'>record</span>
      <span class='seen identifier id'>seen</span> <span class='lshft op'>&lt;&lt;</span> <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='id identifier id'>id</span>
    <span class='end end kw'>end</span>
    <span class='kept identifier id'>kept</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="updated?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>updated?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


143
144
145</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/br_associations/belongs_to_many_association.rb', line 143</span>

<span class='def def kw'>def</span> <span class='updated? fid id'>updated?</span>
  <span class='@updated ivar id'>@updated</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Wed May  5 15:03:44 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool">yard</a>
  0.5.4 (ruby-1.8.7).
</div>

  </body>
</html>