<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=UTF-8" />
<title>Module: BigRecord::DynamicSchema</title>
<link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/app.js"></script>

  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (D)</a> &raquo; 
    <a title="BigRecord" href="../BigRecord.html">BigRecord</a>
     &raquo; 
    <span class="title">DynamicSchema</span>
  
</div>

      <div id="search">
  <a id="class_list_link" href="#">Namespace List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: BigRecord::DynamicSchema 
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/big_record/dynamic_schema.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <h1>Dynamic Schema</h1>
<p>
The dynamic schema functionality of Bigrecord refers to the ability to
modify the attributes of a model within the class itself, rather than being
bounded by the database. This is an inherit property of using the BigTable
database model, and Bigrecord leverages its use.
</p>
<p>
New attributes defined will simply return nil for records that existed
before their addition into the model, while attributes that are removed
from the model will just be ignored when accessing existing records.
</p>
<p>
Refer to <tt><a title="BigRecord::ConnectionAdapters::Column" href="ConnectionAdapters/Column.html">BigRecord::ConnectionAdapters::Column</a></tt> for more information.
</p>


  </div>
</div>
<div class="tags">
  
</div>


  <h2>Method Summary</h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature"><a title="included (class method)" href="#included-class_method">+ (Object) <strong>included</strong>(base) </a>
  
  </span>
  
  
  
  

  
    <span class="summary_desc"></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature"><a title="#add_dynamic_column (instance method)" href="#add_dynamic_column-instance_method">- (Object) <strong>add_dynamic_column</strong>(col) </a>
  
  </span>
  
  
  
  

  
    <span class="summary_desc">
Add an existing dynamic column to this record.

</span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature"><a title="#attributes_from_column_definition_with_dynamic_schema (instance method)" href="#attributes_from_column_definition_with_dynamic_schema-instance_method">- (Object) <strong>attributes_from_column_definition_with_dynamic_schema</strong> </a>
  
  </span>
  
  
  
  

  
    <span class="summary_desc">
Initializes the attributes array with keys matching the columns from the
linked table and the values matching the corresponding default value of
that column, so that a new instance, or one populated from a passed-in
Hash, still has all the attributes that instances loaded from the database
would.

</span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature"><a title="#column_for_attribute_with_dynamic_schema (instance method)" href="#column_for_attribute_with_dynamic_schema-instance_method">- (Object) <strong>column_for_attribute_with_dynamic_schema</strong>(name) </a>
  
  </span>
  
  
  
  

  
    <span class="summary_desc">
Returns the column object for the named attribute.

</span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature"><a title="#column_names (instance method)" href="#column_names-instance_method">- (Object) <strong>column_names</strong> </a>
  
  </span>
  
  
  
  

  
    <span class="summary_desc"></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature"><a title="#columns (instance method)" href="#columns-instance_method">- (Object) <strong>columns</strong> </a>
  
  </span>
  
  
  
  

  
    <span class="summary_desc"></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature"><a title="#columns_hash (instance method)" href="#columns_hash-instance_method">- (Object) <strong>columns_hash</strong> </a>
  
  </span>
  
  
  
  

  
    <span class="summary_desc"></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature"><a title="#define_read_methods_with_dynamic_schema (instance method)" href="#define_read_methods_with_dynamic_schema-instance_method">- (Object) <strong>define_read_methods_with_dynamic_schema</strong> </a>
  
  </span>
  
  
  
  

  
    <span class="summary_desc">
Called on first read access to any given column and generates reader
methods for all columns in the columns_hash if
ActiveRecord::Base.generate_read_methods is set to true.

</span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature"><a title="#dynamic_column (instance method)" href="#dynamic_column-instance_method">- (Object) <strong>dynamic_column</strong>(name, type, options = {}) </a>
  
  </span>
  
  
  
  

  
    <span class="summary_desc">
Create and add a dynamic column to this record.

</span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature"><a title="#initialize_columns (instance method)" href="#initialize_columns-instance_method">- (Object) <strong>initialize_columns</strong>(options = {}) </a>
  
  </span>
  
  
  
  

  
    <span class="summary_desc">
Stub of the callback for setting the dynamic columns.

</span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature"><a title="#inspect_with_dynamic_schema (instance method)" href="#inspect_with_dynamic_schema-instance_method">- (Object) <strong>inspect_with_dynamic_schema</strong> </a>
  
  </span>
  
  
  
  

  
    <span class="summary_desc">
Returns the contents of the record as a nicely formatted string.

</span>
  
</li>

    
  </ul>



  <div id="method_details">
    <h2>Method Details</h2>
    
      <div class="method_details first">
  <p class="signature first" id="included-class_method">
  
    + (<tt><a title="Object" href="../Object.html">Object</a></tt>) <strong>included</strong>(base) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20
21
22
23
24
25</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/dynamic_schema.rb', line 18</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='included identifier id'>included</span><span class='lparen token'>(</span><span class='base identifier id'>base</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='super super kw'>super</span>

  <span class='base identifier id'>base</span><span class='dot token'>.</span><span class='alias_method_chain identifier id'>alias_method_chain</span> <span class='symbol val'>:column_for_attribute</span><span class='comma token'>,</span> <span class='symbol val'>:dynamic_schema</span>
  <span class='base identifier id'>base</span><span class='dot token'>.</span><span class='alias_method_chain identifier id'>alias_method_chain</span> <span class='symbol val'>:attributes_from_column_definition</span><span class='comma token'>,</span> <span class='symbol val'>:dynamic_schema</span>
  <span class='base identifier id'>base</span><span class='dot token'>.</span><span class='alias_method_chain identifier id'>alias_method_chain</span> <span class='symbol val'>:inspect</span><span class='comma token'>,</span> <span class='symbol val'>:dynamic_schema</span>
  <span class='base identifier id'>base</span><span class='dot token'>.</span><span class='alias_method_chain identifier id'>alias_method_chain</span> <span class='symbol val'>:define_read_methods</span><span class='comma token'>,</span> <span class='symbol val'>:dynamic_schema</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="add_dynamic_column-instance_method">
  
    - (<tt><a title="Object" href="../Object.html">Object</a></tt>) <strong>add_dynamic_column</strong>(col) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Add an existing dynamic column to this record
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


37
38
39
40
41</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/dynamic_schema.rb', line 37</span>

<span class='def def kw'>def</span> <span class='add_dynamic_column identifier id'>add_dynamic_column</span><span class='lparen token'>(</span><span class='col identifier id'>col</span><span class='rparen token'>)</span>
  <span class='columns_hash identifier id'>columns_hash</span><span class='lbrack token'>[</span><span class='c identifier id'>c</span><span class='dot token'>.</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='col identifier id'>col</span>
  <span class='@columns_name ivar id'>@columns_name</span><span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='semicolon token'>;</span> <span class='@columns ivar id'>@columns</span><span class='assign token'>=</span> <span class='nil nil kw'>nil</span> <span class='comment val'>#reset</span>
  <span class='col identifier id'>col</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="attributes_from_column_definition_with_dynamic_schema-instance_method">
  
    - (<tt><a title="Object" href="../Object.html">Object</a></tt>) <strong>attributes_from_column_definition_with_dynamic_schema</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Initializes the attributes array with keys matching the columns from the
linked table and the values matching the corresponding default value of
that column, so that a new instance, or one populated from a passed-in
Hash, still has all the attributes that instances loaded from the database
would.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


68
69
70
71
72
73
74
75</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/dynamic_schema.rb', line 68</span>

<span class='def def kw'>def</span> <span class='attributes_from_column_definition_with_dynamic_schema identifier id'>attributes_from_column_definition_with_dynamic_schema</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='columns identifier id'>columns</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attributes identifier id'>attributes</span><span class='comma token'>,</span> <span class='column identifier id'>column</span><span class='bitor op'>|</span>
    <span class='unless unless kw'>unless</span> <span class='column identifier id'>column</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='eq op'>==</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='primary_key identifier id'>primary_key</span>
      <span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='column identifier id'>column</span><span class='dot token'>.</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='column identifier id'>column</span><span class='dot token'>.</span><span class='default identifier id'>default</span>
    <span class='end end kw'>end</span>
    <span class='attributes identifier id'>attributes</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="column_for_attribute_with_dynamic_schema-instance_method">
  
    - (<tt><a title="Object" href="../Object.html">Object</a></tt>) <strong>column_for_attribute_with_dynamic_schema</strong>(name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the column object for the named attribute.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


60
61
62</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/dynamic_schema.rb', line 60</span>

<span class='def def kw'>def</span> <span class='column_for_attribute_with_dynamic_schema identifier id'>column_for_attribute_with_dynamic_schema</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='columns_hash identifier id'>columns_hash</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="column_names-instance_method">
  
    - (<tt><a title="Object" href="../Object.html">Object</a></tt>) <strong>column_names</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/dynamic_schema.rb', line 55</span>

<span class='def def kw'>def</span> <span class='column_names identifier id'>column_names</span>
  <span class='@column_names ivar id'>@column_names</span> <span class='opasgn op'>||=</span> <span class='columns_hash identifier id'>columns_hash</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="columns-instance_method">
  
    - (<tt><a title="Object" href="../Object.html">Object</a></tt>) <strong>columns</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


51
52
53</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/dynamic_schema.rb', line 51</span>

<span class='def def kw'>def</span> <span class='columns identifier id'>columns</span>
  <span class='@columns ivar id'>@columns</span> <span class='opasgn op'>||=</span> <span class='columns_hash identifier id'>columns_hash</span><span class='dot token'>.</span><span class='values identifier id'>values</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="columns_hash-instance_method">
  
    - (<tt><a title="Object" href="../Object.html">Object</a></tt>) <strong>columns_hash</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45
46
47
48
49</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/dynamic_schema.rb', line 43</span>

<span class='def def kw'>def</span> <span class='columns_hash identifier id'>columns_hash</span>
  <span class='unless unless kw'>unless</span> <span class='@columns_hash ivar id'>@columns_hash</span>
    <span class='@columns_hash ivar id'>@columns_hash</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='columns_hash identifier id'>columns_hash</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
    <span class='initialize_columns identifier id'>initialize_columns</span>
  <span class='end end kw'>end</span>
  <span class='@columns_hash ivar id'>@columns_hash</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="define_read_methods_with_dynamic_schema-instance_method">
  
    - (<tt><a title="Object" href="../Object.html">Object</a></tt>) <strong>define_read_methods_with_dynamic_schema</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Called on first read access to any given column and generates reader
methods for all columns in the columns_hash if
ActiveRecord::Base.generate_read_methods is set to true.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


90
91
92
93
94
95
96
97
98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/dynamic_schema.rb', line 90</span>

<span class='def def kw'>def</span> <span class='define_read_methods_with_dynamic_schema identifier id'>define_read_methods_with_dynamic_schema</span>
  <span class='columns_hash identifier id'>columns_hash</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='column identifier id'>column</span><span class='bitor op'>|</span>
    <span class='unless unless kw'>unless</span> <span class='respond_to_without_attributes? fid id'>respond_to_without_attributes?</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
      <span class='define_read_method identifier id'>define_read_method</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='column identifier id'>column</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

    <span class='unless unless kw'>unless</span> <span class='respond_to_without_attributes? fid id'>respond_to_without_attributes?</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{name}?&quot;</span><span class='rparen token'>)</span>
      <span class='define_question_method identifier id'>define_question_method</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="dynamic_column-instance_method">
  
    - (<tt><a title="Object" href="../Object.html">Object</a></tt>) <strong>dynamic_column</strong>(name, type, options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Create and add a dynamic column to this record
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/dynamic_schema.rb', line 32</span>

<span class='def def kw'>def</span> <span class='dynamic_column identifier id'>dynamic_column</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='add_dynamic_column identifier id'>add_dynamic_column</span> <span class='ConnectionAdapters constant id'>ConnectionAdapters</span><span class='colon2 op'>::</span><span class='Column constant id'>Column</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='comma token'>,</span> <span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="initialize_columns-instance_method">
  
    - (<tt><a title="Object" href="../Object.html">Object</a></tt>) <strong>initialize_columns</strong>(options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Stub of the callback for setting the dynamic columns. Override this to add
dynamic columns
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


28
29</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/dynamic_schema.rb', line 28</span>

<span class='def def kw'>def</span> <span class='initialize_columns identifier id'>initialize_columns</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="inspect_with_dynamic_schema-instance_method">
  
    - (<tt><a title="Object" href="../Object.html">Object</a></tt>) <strong>inspect_with_dynamic_schema</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the contents of the record as a nicely formatted string.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


78
79
80
81
82
83
84
85</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/big_record/dynamic_schema.rb', line 78</span>

<span class='def def kw'>def</span> <span class='inspect_with_dynamic_schema identifier id'>inspect_with_dynamic_schema</span>
  <span class='attributes_as_nice_string identifier id'>attributes_as_nice_string</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='column_names identifier id'>column_names</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='has_attribute? fid id'>has_attribute?</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='new_record? fid id'>new_record?</span>
      <span class='dstring node'>&quot;#{name}: #{attribute_for_inspect(name)}&quot;</span>
    <span class='end end kw'>end</span>
  <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;, &quot;</span><span class='rparen token'>)</span>
  <span class='dstring node'>&quot;#&lt;#{self.class} #{attributes_as_nice_string}&gt;&quot;</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Tue Dec  1 18:30:50 2009 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool">yard</a>
  0.4.0 (ruby-1.8.7).
</div>

  </body>
</html>